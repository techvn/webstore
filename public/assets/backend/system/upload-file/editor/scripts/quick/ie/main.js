function getHTMLBody(idIframe){var oEditor=eval(idIframe);sHTML=oEditor.document.body.innerHTML;sHTML=String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig,'<PARAM NAME="Play" VALUE="-1">');return sHTML}function insertHTML(g,c){var e=g;var a=e.document.selection.createRange();var f=String(c).match(/<A[^>]*>/ig);if(f){for(var b=0;b<f.length;b++){sTmp=f[b].replace(/href=/,"href_iwe=");c=String(c).replace(f[b],sTmp)}}var d=String(c).match(/<IMG[^>]*>/ig);if(d){for(var b=0;b<d.length;b++){sTmp=d[b].replace(/src=/,"src_iwe=");c=String(c).replace(d[b],sTmp)}}if(a.parentElement){a.pasteHTML(c)}else{a.item(0).outerHTML=c}for(var b=0;b<e.document.all.length;b++){if(e.document.all[b].getAttribute("href_iwe")){e.document.all[b].href=e.document.all[b].getAttribute("href_iwe");e.document.all[b].removeAttribute("href_iwe",0)}if(e.document.all[b].getAttribute("src_iwe")){e.document.all[b].src=e.document.all[b].getAttribute("src_iwe");e.document.all[b].removeAttribute("src_iwe",0)}}}function doCmd(idIframe,sCmd,sOption){var oEditor=eval(idIframe);var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;var oTarget=(sType=="None"?oEditor.document:oSel);oTarget.execCommand(sCmd,false,sOption)}function toggleViewSource(a,b){if(a.checked){viewSource(b)}else{applySource(b)}}function viewSource(idIframe){var oEditor=eval(idIframe);var sHTML=oEditor.document.body.innerHTML;var docBody=oEditor.document.body;docBody.innerHTML="";docBody.innerText=sHTML}function applySource(idIframe){var oEditor=eval(idIframe);var s=oEditor.document.documentElement.outerHTML;var arrTmp=s.split("<BODY");var beforeBody=arrTmp[0]+"<BODY"+arrTmp[1].substring(0,arrTmp[1].indexOf(">")+1);var afterBody=s.substr(s.indexOf("</BODY>"));var body=oEditor.document.body.innerText;var oDoc=oEditor.document.open("text/html","replace");oDoc.write(beforeBody+body+afterBody);oDoc.close();oEditor.document.body.contentEditable=true;oEditor.document.execCommand("2D-Position",true,true);oEditor.document.execCommand("MultipleSelection",true,true);oEditor.document.execCommand("LiveResize",true,true);oEditor.document.body.onmouseup=function(){oUtil.oEditor=oEditor}};