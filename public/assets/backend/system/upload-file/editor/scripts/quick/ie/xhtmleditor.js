var oUtil=new EditorUtil();function EditorUtil(){this.obj=null;this.oEditor=null;this.arrEditor=[];var a=document.getElementsByTagName("script");for(var c=0;c<a.length;c++){var b=a[c].src.toLowerCase();if(b.indexOf("scripts/quick/ie/xhtmleditor.js")!=-1){this.scriptPath=a[c].src.replace(/quick\/ie\/xhtmleditor.js/ig,"")}}}function InnovaEditor(oName){this.oName=oName;this.height="400px";this.width="100%";this.heightAdjustment=-20;this.rangeBookmark=null;this.controlBookmark=null;this.RENDER=RENDER;this.doCmd=edt_doCmd;this.getHTMLBody=edt_getHTMLBody;this.getXHTMLBody=edt_getXHTMLBody;this.insertHTML=edt_insertHTML;this.cleanDeprecated=edt_cleanDeprecated;this.cleanEmptySpan=edt_cleanEmptySpan;this.cleanFonts=edt_cleanFonts;this.cleanTags=edt_cleanTags;this.replaceTags=edt_replaceTags;this.toggleViewSource=edt_toggleViewSource;this.viewSource=edt_viewSource;this.applySource=edt_applySource;this.encodeIO=false;this.init=function(){return true};this.bookmarkSelection=function(){var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection;var oRange=oSel.createRange();if(oSel.type=="None"||oSel.type=="Text"){this.rangeBookmark=oRange;this.controlBookmark=null}else{this.controlBookmark=oRange.item(0);this.rangeBookmark=null}};this.setFocus=function(){var oEditor=eval("idContent"+this.oName);oEditor.focus();try{if(this.rangeBookmark!=null){var oSel=oEditor.document.selection;var oRange=oSel.createRange();var bmRange=this.rangeBookmark;if(bmRange.parentElement()){oRange.moveToElementText(bmRange.parentElement());oRange.setEndPoint("StarttoStart",bmRange);oRange.setEndPoint("EndToEnd",bmRange);oRange.select()}}else{if(this.controlBookmark!=null){var oSel=oEditor.document.body.createControlRange();oSel.add(this.controlBookmark);oSel.select()}}}catch(e){}};this.adjustHeight=function(){if(document.compatMode&&document.compatMode!="BackCompat"){if(String(this.height).indexOf("%")==-1){var eh=parseInt(this.height,10);eh+=parseInt(this.heightAdjustment,10);this.height=eh+"px";var edtArea=document.getElementById("idArea"+oName);edtArea.style.height=this.height}}}}function RENDER(){}function edt_doCmd(sCmd,sOption){var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;var oTarget=(sType=="None"?oEditor.document:oSel);oTarget.execCommand(sCmd,false,sOption)}function edt_getHTMLBody(){var oEditor=eval("idContent"+this.oName);sHTML=oEditor.document.body.innerHTML;sHTML=String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig,'<PARAM NAME="Play" VALUE="-1">');if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}return sHTML}function edt_getXHTMLBody(){var sHTML="";if(document.getElementById("chkViewSource"+this.oName).checked){var oEditor=eval("idContent"+this.oName);sHTML=oEditor.document.body.innerText}else{var oEditor=eval("idContent"+this.oName);this.cleanDeprecated();sHTML=recur(oEditor.document.body,"")}if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}return sHTML}function edt_insertHTML(sHTML){var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var arrA=String(sHTML).match(/<A[^>]*>/ig);if(arrA){for(var i=0;i<arrA.length;i++){sTmp=arrA[i].replace(/href=/,"href_iwe=");sHTML=String(sHTML).replace(arrA[i],sTmp)}}var arrB=String(sHTML).match(/<IMG[^>]*>/ig);if(arrB){for(var i=0;i<arrB.length;i++){sTmp=arrB[i].replace(/src=/,"src_iwe=");sHTML=String(sHTML).replace(arrB[i],sTmp)}}if(oSel.parentElement){oSel.pasteHTML(sHTML)}else{oSel.item(0).outerHTML=sHTML}for(var i=0;i<oEditor.document.all.length;i++){if(oEditor.document.all[i].getAttribute("href_iwe")){oEditor.document.all[i].href=oEditor.document.all[i].getAttribute("href_iwe");oEditor.document.all[i].removeAttribute("href_iwe",0)}if(oEditor.document.all[i].getAttribute("src_iwe")){oEditor.document.all[i].src=oEditor.document.all[i].getAttribute("src_iwe");oEditor.document.all[i].removeAttribute("src_iwe",0)}}}function edt_cleanDeprecated(){var oEditor=eval("idContent"+this.oName);var elements;elements=oEditor.document.body.getElementsByTagName("STRIKE");this.cleanTags(elements,"line-through");elements=oEditor.document.body.getElementsByTagName("S");this.cleanTags(elements,"line-through");elements=oEditor.document.body.getElementsByTagName("U");this.cleanTags(elements,"underline");this.replaceTags("DIR","DIV");this.replaceTags("MENU","DIV");this.replaceTags("CENTER","DIV");this.replaceTags("XMP","PRE");this.replaceTags("BASEFONT","SPAN");elements=oEditor.document.body.getElementsByTagName("APPLET");var count=elements.length;while(count>0){f=elements[0];f.removeNode(false);count--}this.cleanFonts();this.cleanEmptySpan();return true}function edt_cleanEmptySpan(){var bReturn=false;var oEditor=eval("idContent"+this.oName);var allSpans=oEditor.document.getElementsByTagName("SPAN");if(allSpans.length==0){return false}var emptySpans=[];var reg=/<\s*SPAN\s*>/gi;for(var i=0;i<allSpans.length;i++){if(allSpans[i].outerHTML.search(reg)==0){emptySpans[emptySpans.length]=allSpans[i]}}var theSpan,theParent;for(var i=0;i<emptySpans.length;i++){theSpan=emptySpans[i];theSpan.removeNode(false);bReturn=true}return bReturn}function edt_cleanFonts(){var oEditor=eval("idContent"+this.oName);var allFonts=oEditor.document.body.getElementsByTagName("FONT");if(allFonts.length==0){return false}var f;while(allFonts.length>0){f=allFonts[0];if(f.hasChildNodes&&f.childNodes.length==1&&f.childNodes[0].nodeType==1&&f.childNodes[0].nodeName=="SPAN"){copyAttribute(f.childNodes[0],f);f.removeNode(false)}else{if(f.parentElement.nodeName=="SPAN"&&f.parentElement.childNodes.length==1){copyAttribute(f.parentElement,f);f.removeNode(false)}else{var newSpan=oEditor.document.createElement("SPAN");copyAttribute(newSpan,f);newSpan.innerHTML=f.innerHTML;f.replaceNode(newSpan)}}}return true}function edt_cleanTags(elements,sVal){var oEditor=eval("idContent"+this.oName);var f;while(elements.length>0){f=elements[0];if(f.hasChildNodes&&f.childNodes.length==1&&f.childNodes[0].nodeType==1&&f.childNodes[0].nodeName=="SPAN"){if(sVal=="bold"){f.childNodes[0].style.fontWeight="bold"}if(sVal=="italic"){f.childNodes[0].style.fontStyle="italic"}if(sVal=="line-through"){f.childNodes[0].style.textDecoration="line-through"}if(sVal=="underline"){f.childNodes[0].style.textDecoration="underline"}f.removeNode(false)}else{if(f.parentElement.nodeName=="SPAN"&&f.parentElement.childNodes.length==1){if(sVal=="bold"){f.parentElement.style.fontWeight="bold"}if(sVal=="italic"){f.parentElement.style.fontStyle="italic"}if(sVal=="line-through"){f.parentElement.style.textDecoration="line-through"}if(sVal=="underline"){f.parentElement.style.textDecoration="underline"}f.removeNode(false)}else{var newSpan=oEditor.document.createElement("SPAN");if(sVal=="bold"){newSpan.style.fontWeight="bold"}if(sVal=="italic"){newSpan.style.fontStyle="italic"}if(sVal=="line-through"){newSpan.style.textDecoration="line-through"}if(sVal=="underline"){newSpan.style.textDecoration="underline"}newSpan.innerHTML=f.innerHTML;f.replaceNode(newSpan)}}}}function edt_replaceTags(sFrom,sTo){var oEditor=eval("idContent"+this.oName);var elements=oEditor.document.getElementsByTagName(sFrom);var newSpan;var count=elements.length;while(count>0){f=elements[0];newSpan=oEditor.document.createElement(sTo);newSpan.innerHTML=f.innerHTML;f.replaceNode(newSpan);count--}}function copyAttribute(b,c){if((c.face!=null)&&(c.face!="")){b.style.fontFamily=c.face}if((c.size!=null)&&(c.size!="")){var a="";if(c.size==1){a="8pt"}else{if(c.size==2){a="10pt"}else{if(c.size==3){a="12pt"}else{if(c.size==4){a="14pt"}else{if(c.size==5){a="18pt"}else{if(c.size==6){a="24pt"}else{if(c.size>=7){a="36pt"}else{if(c.size<=-2||c.size=="0"){a="8pt"}else{if(c.size=="-1"){a="10pt"}else{if(c.size==0){a="12pt"}else{if(c.size=="+1"){a="14pt"}else{if(c.size=="+2"){a="18pt"}else{if(c.size=="+3"){a="24pt"}else{if(c.size=="+4"||c.size=="+5"||c.size=="+6"){a="36pt"}else{a=""}}}}}}}}}}}}}}if(a!=""){b.style.fontSize=a}}if((c.style.backgroundColor!=null)&&(c.style.backgroundColor!="")){b.style.backgroundColor=c.style.backgroundColor}if((c.color!=null)&&(c.color!="")){b.style.color=c.color}}function GetElement(b,a){while(b!=null&&b.tagName!=a){if(b.tagName=="BODY"){return null}b=b.parentElement}return b}function lineBreak1(a){arrReturn=["\n","",""];if(a=="A"||a=="B"||a=="CITE"||a=="CODE"||a=="EM"||a=="FONT"||a=="I"||a=="SMALL"||a=="STRIKE"||a=="BIG"||a=="STRONG"||a=="SUB"||a=="SUP"||a=="U"||a=="SAMP"||a=="S"||a=="VAR"||a=="BASEFONT"||a=="KBD"||a=="TT"){arrReturn=["","",""]}if(a=="TEXTAREA"||a=="TABLE"||a=="THEAD"||a=="TBODY"||a=="TR"||a=="OL"||a=="UL"||a=="DIR"||a=="MENU"||a=="FORM"||a=="SELECT"||a=="MAP"||a=="DL"||a=="HEAD"||a=="BODY"||a=="HTML"){arrReturn=["\n","","\n"]}if(a=="STYLE"||a=="SCRIPT"){arrReturn=["\n","",""]}if(a=="BR"||a=="HR"){arrReturn=["","\n",""]}return arrReturn}function fixAttr(a){a=String(a).replace(/&/g,"&amp;");a=String(a).replace(/</g,"&lt;");a=String(a).replace(/"/g,"&quot;");return a}function fixVal(b){b=String(b).replace(/&/g,"&amp;");b=String(b).replace(/</g,"&lt;");var a=escape(b);a=unescape(a.replace(/\%A0/gi,"-*REPL*-"));b=a.replace(/-\*REPL\*-/gi,"&nbsp;");return b}function recur(m,j){var k=navigator.userAgent.toLowerCase();var l=(k.indexOf("msie 9.0")>=0)?true:false;var p="";for(var q=0;q<m.childNodes.length;q++){var g=m.childNodes[q];if(g.parentNode!=m){continue}if(g.nodeType==1){var a=g.nodeName;var o=g.outerHTML;if(o.indexOf("<?xml:namespace")>-1){o=o.substr(o.indexOf(">")+1)}o=o.substring(1,o.indexOf(">"));if(o.indexOf(" ")>-1){o=o.substring(0,o.indexOf(" "))}var e=false;if(a.substring(0,1)=="/"){e=true}else{var d=j;p+=lineBreak1(a)[0];if(lineBreak1(a)[0]!=""){p+=d}}if(e){}else{if(a=="OBJECT"||a=="EMBED"){s=getOuterHTML(g);s=s.replace(/\"[^\"]*\"/ig,function(i){i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#").replace(/&amp;amp;/gi,"&amp;");return i});s=s.replace(/<([^ >]*)/ig,function(i){return i.toLowerCase()});s=s.replace(/ ([^=]+)=([^"' >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(i){return i.toLowerCase()});s=s.replace(/#_#/ig," ");if(a=="EMBED"){if(g.innerHTML==""){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>")}}s=s.replace(/<param name=\"Play\" value=\"0\" \/>/,'<param name="Play" value="-1" />');p+=s}else{if(a=="TITLE"){p+="<title>"+g.innerHTML+"</title>"}else{if(a=="AREA"){var r=g.coords;var h=g.shape}if(a=="BODY"){var u=g.outerHTML;if(l){u=getOuterHTML(g)}var u=getOuterHTML(g);s=u.substring(0,u.indexOf(">")+1)}else{var t=g.cloneNode();if(g.checked){t.checked=g.checked}if(g.selected){t.selected=g.selected}s=t.outerHTML.replace(/<\/[^>]*>/,"");if(l){s=getOuterHTML(t).replace(/<\/[^>]*>/,"")}}if(a=="STYLE"){var c=s.match(/<[^>]*>/ig);s=c[0]}s=s.replace(/\"[^\"]*\"/ig,function(i){i=i.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s+/ig,"#_#");return i});s=s.replace(/<([^ >]*)/ig,function(i){return i.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(i){return i.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/(<hr[^>]*)(noshade=""|noshade )/ig,'$1noshade="noshade" ');s=s.replace(/(<input[^>]*)(checked=""|checked )/ig,'$1checked="checked" ');s=s.replace(/(<select[^>]*)(multiple=""|multiple )/ig,'$1multiple="multiple" ');s=s.replace(/(<option[^>]*)(selected=""|selected )/ig,'$1selected="true" ');s=s.replace(/(<input[^>]*)(readonly=""|readonly )/ig,'$1readonly="readonly" ');s=s.replace(/(<input[^>]*)(disabled=""|disabled )/ig,'$1disabled="disabled" ');s=s.replace(/(<td[^>]*)(nowrap=""|nowrap )/ig,'$1nowrap="nowrap" ');s=s.replace(/(<td[^>]*)(nowrap=""\>|nowrap\>)/ig,'$1nowrap="nowrap">');s=s.replace(/ contenteditable=\"true\"/ig,"");if(a=="AREA"){s=s.replace(/ coords=\"0,0,0,0\"/ig,' coords="'+r+'"');s=s.replace(/ shape=\"RECT\"/ig,' shape="'+h+'"')}var n=true;if(a=="IMG"||a=="BR"||a=="AREA"||a=="HR"||a=="INPUT"||a=="BASE"||a=="LINK"){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>");n=false}p+=s;if(a!="TEXTAREA"){p+=lineBreak1(a)[1]}if(a!="TEXTAREA"){if(lineBreak1(a)[1]!=""){p+=d}}if(n){s=g.outerHTML;if(a=="SCRIPT"){s=s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig,"<script$1>");s=s.replace(/[\n+\s+\t+]*<\/script>/ig,"<\/script>");s=s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig,"");s=s.replace(/\/\/\]\]><\/script>/ig,"");s=s.replace(/<script([^>]*)>/ig,"");s=s.replace(/<\/script>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");p+="\n"+d+"//<![CDATA[\n"+d+s+"\n"+d+"//]]>\n"+d}if(a=="STYLE"){s=s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig,"<style$1>");s=s.replace(/[\n+\s+\t+]*<\/style>/ig,"</style>");s=s.replace(/<style([^>]*)><!--/ig,"");s=s.replace(/--><\/style>/ig,"");s=s.replace(/<style([^>]*)>/ig,"");s=s.replace(/<\/style>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");p+="\n"+d+"<!--\n"+d+s+"\n"+d+"-->\n"+d}if(a=="DIV"||a=="P"){if(g.innerHTML==""||g.innerHTML=="&nbsp;"){p+="&nbsp;"}else{p+=recur(g,d+"\t")}}else{if(a=="STYLE"||a=="SCRIPT"){}else{p+=recur(g,d+"\t")}}if(a!="TEXTAREA"){p+=lineBreak1(a)[2]}if(a!="TEXTAREA"){if(lineBreak1(a)[2]!=""){p+=d}}if(o.indexOf(":")>=0){p+="</"+o.toLowerCase()+">"}else{p+="</"+a.toLowerCase()+">"}}}}}}else{if(g.nodeType==3){p+=fixVal(g.nodeValue).replace(/^[\t\r\n\v\f]*/,"").replace(/[\t\r\n\v\f]*$/,"")}else{if(g.nodeType==8){var b=g.nodeValue;b=b.replace(/^\s+/,"").replace(/\s+$/,"");var d="";p+="\n"+d+"<!--\n"+d+b+"\n"+d+"-->\n"+d}else{}}}}return p}function edt_toggleViewSource(a){if(a.checked){this.viewSource()}else{this.applySource()}}function edt_viewSource(){var oEditor=eval("idContent"+this.oName);this.cleanDeprecated();var sHTML=recur(oEditor.document.body,"");var docBody=oEditor.document.body;docBody.innerHTML="";docBody.innerText=sHTML.replace(/\n+/,"")}function edt_applySource(){var oEditor=eval("idContent"+this.oName);var s=oEditor.document.documentElement.outerHTML;s=s.replace(/<body/gi,"<body");s=s.replace(/<\/body>/gi,"</body>");var arrTmp=s.split("<body");var beforeBody=arrTmp[0]+"<body"+arrTmp[1].substring(0,arrTmp[1].indexOf(">")+1);var afterBody=s.substr(s.indexOf("</body>"));var body=oEditor.document.body.innerText;var oDoc=oEditor.document.open("text/html","replace");oDoc.write(beforeBody+body+afterBody);oDoc.close();oEditor.document.body.contentEditable=true;oEditor.document.execCommand("2D-Position",true,true);oEditor.document.execCommand("MultipleSelection",true,true);oEditor.document.execCommand("LiveResize",true,true);oEditor.document.body.onmouseup=function(){oUtil.oEditor=oEditor}}function encodeHTMLCode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getOuterHTML(e){var d="";switch(e.nodeType){case 1:d="<"+e.nodeName;var g="";for(var b=0;b<e.attributes.length;b++){if(e.attributes[b].nodeName.substr(0,4)=="_moz"){continue}if(e.attributes[b].nodeValue.substr(0,4)=="_moz"){continue}if(e.nodeName=="TEXTAREA"&&e.attributes[b].nodeName.toLowerCase()=="value"){g=e.attributes[b].nodeValue}else{d+=" "+e.attributes[b].nodeName+'="'+e.attributes[b].nodeValue.replace(/"/gi,"'")+'"'}}d+=">";if(e.nodeName=="TEXTAREA"){d+=g}else{if(e.nodeName=="OBJECT"){var c;for(var a=0;a<e.childNodes.length;a++){c=e.childNodes[a];if(c.nodeType==1){if(c.tagName=="PARAM"){d+='<param name="'+c.name+'" value="'+c.value.replace(/"/gi,"'")+'"/>\n'}else{if(c.tagName=="EMBED"){d+=getOuterHTML(c)}}}}}else{d+=e.innerHTML}}d+="</"+e.nodeName+">";break;case 8:d="<!--"+e.nodeValue+"-->";break;case 3:d=e.nodeValue;break}return d}function ISWindow(i){var b=navigator.userAgent.toUpperCase();var c=(b.indexOf("MSIE")>=0)?true:false,g=(b.indexOf("MSIE 7.0")>=0),e=(b.indexOf("MSIE 8.0")>=0),h=(!g&&!e&&c),a=(c&&document.compatMode=="BackCompat");var d=this;this.id=i;this.opts=null;this.rt={};this.iconPath="icons/";ISWindow.objs[i]=this;this.show=function(j){if(!document.getElementById(this.id)){var l=document.createElement("div");l.id="cnt$"+this.id;l.innerHTML=this.render(j.url);document.body.insertBefore(l,document.body.childNodes[0])}if(!this.rt.win){this.rt.win=document.getElementById(this.id);this.rt.frm=document.getElementById("frm$"+this.id);this.rt.ttl=document.getElementById("ttl$"+this.id)}if(j.overlay==true){this.showOverlay()}this.setSize(j.width,j.height,j.center);ISWindow.zIndex+=2;this.rt.win.style.zIndex=ISWindow.zIndex;this.rt.win.style.display="block";var k=function(){d.rt.ttl.innerHTML=d.rt.frm.contentWindow.document.title;d.rt.frm.contentWindow.openerWin=j.openerWin?j.openerWin:window;d.rt.frm.contentWindow.opener=j.openerWin?j.openerWin:window;d.rt.frm.contentWindow.options=j.options?j.options:{};d.rt.frm.contentWindow.close=function(){d.close()};if(typeof(d.rt.frm.contentWindow.bodyOnLoad)!="undefined"){d.rt.frm.contentWindow.bodyOnLoad()}};if(this.rt.frm.attachEvent){this.rt.frm.attachEvent("onload",k)}if(this.rt.frm.addEventListener){this.rt.frm.addEventListener("load",k,true)}setTimeout(function(){d.rt.frm.src=j.url},0)};this.close=function(){var j=document.getElementById("cnt$"+this.id);if(j){if(this.rt.frm.contentWindow.bodyOnUnload){this.rt.frm.contentWindow.bodyOnUnload()}j.parentNode.removeChild(j)}this.hideOverlay()};this.hide=function(){if(!this.rt.win){this.rt.win=document.getElementById(this.id)}this.rt.win.style.display="none"};this.showOverlay=function(){var m;if(!document.getElementById("ovr$"+this.id)){m=document.createElement("div");m.id="ovr$"+this.id;m.style.display="none";m.style.position=(h||a?"absolute":"fixed");m.style.backgroundColor="#ffffff";m.style.filter="alpha(opacity=35)";m.style.mozOpacity="0.4";m.style.opacity="0.4";m.style.Opacity="0.4";document.body.insertBefore(m,document.body.childNodes[0])}var k=ISWindow.clientSize();if(h||a){var l=document.body,p=document.documentElement,j,o;j=Math.min(Math.max(l.scrollWidth,p.scrollWidth),Math.max(l.offsetWidth,p.offsetWidth));var n=((p.scrollHeight<p.offsetHeight)||(l.scrollHeight<l.offsetHeight))?Math.min:Math.max;o=n(Math.max(l.scrollHeight,p.scrollHeight),Math.max(l.offsetHeight,p.offsetHeight));k.w=Math.max(k.w,j);k.h=Math.max(k.h,o);m.style.position="absolute"}m.style.width=k.w+"px";m.style.height=k.h+"px";m.style.top="0px";m.style.left="0px";m.style.zIndex=ISWindow.zIndex+1;m.style.display="block"};this.hideOverlay=function(){var j=document.getElementById("ovr$"+this.id);if(j){j.style.display="none"}};this.setSize=function(k,l,j){this.rt.win.style.width=k;this.rt.win.style.height=l;this.rt.frm.style.height=parseInt(l,10)-30+"px";if(j){this.center()}};this.center=function(){var m=ISWindow.clientSize();var k=parseInt(this.rt.win.style.width,10),j=parseInt(this.rt.win.style.height,10);k=(isNaN(k)?0:(k>m.w?m.w:k));j=(isNaN(j)?0:(j>m.h?m.h:j));var l={x:(m.w-k)/2,y:(m.h-j)/2};if(h||a){l.x=l.x+(document.body.scrollLeft||document.documentElement.scrollLeft);l.y=l.y+(document.body.scrollTop||document.documentElement.scrollTop)}this.setPosition(l.x,l.y)};this.setPosition=function(j,k){this.rt.win.style.top=k+"px";this.rt.win.style.left=j+"px"};this.render=function(k){var m=[],l=0,n=h||a?"absolute":"fixed";m[l++]="<div style='position:"+n+";display:none;z-index:100000;background-color:#ffffff;filter:alpha(opacity=25);opacity:0.25;-moz-opacity:0.25;border:#999999 1px solid' id=\"dd$"+this.id+'"></div>';m[l++]="<div unselectable='on' id=\""+this.id+"\" style='position:"+n+";z-index:100000;border:#d7d7d7 1px solid;'>";m[l++]='  <div unselectable="on" style="cursor:move;height:30px;background-image:url('+this.iconPath+'dialogbg.gif);" onmousedown="ISWindow._ddMouseDown(event, \''+this.id+'\');"><span style="font-weight:bold;float:left;margin-top:7px;margin-left:11px;" id="ttl$'+this.id+'"></span><img src="'+this.iconPath+'btnClose.gif" onmousedown="event.cancelBubble=true;if(event.preventDefault) event.preventDefault();" onclick="ISWindow.objs[\''+this.id+"'].close();\" style='float:right;margin-top:5px;margin-right:5px;cursor:pointer' /></div>";m[l++]='  <iframe id="frm$'+this.id+'" style="width:100%;" frameborder=\'no\'></iframe>';m[l++]="</div>";return m.join("")};ISWindow.clientSize=function(){return{w:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}};ISWindow._ddMouseDown=function(k,j){var l=document;l.onmousemove=function(m){ISWindow._startDrag(m?m:k)};l.onmouseup=function(m){ISWindow._endDrag(m?m:k)};l.onselectstart=function(){return false};l.onmousedown=function(){return false};l.ondragstart=function(){return false};ISWindow.trgElm=document.getElementById(j);ISWindow.gstElm=document.getElementById("dd$"+j);ISWindow.gstElm.style.top=ISWindow.trgElm.style.top;ISWindow.gstElm.style.left=ISWindow.trgElm.style.left;ISWindow.gstElm.style.width=ISWindow.trgElm.style.width;ISWindow.gstElm.style.height=ISWindow.trgElm.style.height;ISWindow.gstElm.style.display="block";ISWindow.posDif={x:k.clientX-parseInt(ISWindow.trgElm.style.left,10),y:k.clientY-parseInt(ISWindow.trgElm.style.top,10)}};ISWindow._startDrag=function(j){ISWindow.gstElm.style.left=(j.clientX-ISWindow.posDif.x)+"px";ISWindow.gstElm.style.top=(j.clientY-ISWindow.posDif.y)+"px"};ISWindow._endDrag=function(j){ISWindow.gstElm.style.display="none";ISWindow.trgElm.style.top=ISWindow.gstElm.style.top;ISWindow.trgElm.style.left=ISWindow.gstElm.style.left;document.onmousemove=null;document.onmouseup=null;document.onmousedown=function(){return true};document.onselectstart=function(){return true};document.onselectstart=function(){return true}}}ISWindow.objs={};ISWindow.zIndex=2000;