var onloadOverrided=false;function onload_new(){onload_original();setMozEdit()}function onload_original(){}function setMozEdit(b){if((b!=null)&&(b!="")){try{document.getElementById(b).contentDocument.designMode="on"}catch(c){}}else{for(var a=0;a<oUtil.arrIframe.length;a++){try{document.getElementById(oUtil.arrIframe[a]).contentDocument.designMode="on"}catch(c){alert(c)}}}}function doCmd(a,d,c){var b=document.getElementById(a).contentWindow;b.document.execCommand(d,false,c)}function getHTMLBody(a){var b=document.getElementById(a).contentWindow;sHTML=b.document.body.innerHTML;sHTML=String(sHTML).replace(/ contentEditable=true/g,"");sHTML=String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig,'<PARAM NAME="Play" VALUE="-1">');return sHTML}function getXHTMLBody(a){var b=document.getElementById(a).contentWindow;this.cleanDeprecated(a);return recur(b.document.body,"")}function insertHTML(d,h){var j=document.getElementById(d).contentWindow;var a=j.getSelection();var b=a.getRangeAt(0);var c=b.createContextualFragment(h);b.collapse(true);var g=c.childNodes[c.childNodes.length-1];b.insertNode(c);try{j.document.designMode="on"}catch(i){}if(g.nodeType==Node.TEXT_NODE){b=j.document.createRange();b.setStart(g,g.nodeValue.length);b.setEnd(g,g.nodeValue.length);a=j.getSelection();a.removeAllRanges();a.addRange(b)}}function cleanDeprecated(a){var d=document.getElementById(a).contentWindow;var c;c=d.document.body.getElementsByTagName("STRIKE");this.cleanTags(a,c,"line-through");c=d.document.body.getElementsByTagName("S");this.cleanTags(a,c,"line-through");c=d.document.body.getElementsByTagName("U");this.cleanTags(a,c,"underline");this.replaceTags(a,"DIR","DIV");this.replaceTags(a,"MENU","DIV");this.replaceTags(a,"CENTER","DIV");this.replaceTags(a,"XMP","PRE");this.replaceTags(a,"BASEFONT","SPAN");c=d.document.body.getElementsByTagName("APPLET");while(c.length>0){var b=c[0];theParent=b.parentNode;theParent.removeChild(b)}this.cleanFonts(a);this.cleanEmptySpan(a);return true}function cleanEmptySpan(l){var b=false;var j=document.getElementById(l).contentWindow;var a=/<\s*SPAN\s*>/gi;while(true){var h=j.document.getElementsByTagName("SPAN");if(h.length==0){break}var m=[];for(var e=0;e<h.length;e++){if(getOuterHTML(h[e]).search(a)==0){m[m.length]=h[e]}}if(m.length==0){break}var d,c;for(var e=0;e<m.length;e++){d=m[e];c=d.parentNode;if(!c){continue}if(d.hasChildNodes()){var g=j.document.createRange();g.selectNodeContents(d);var k=g.extractContents();c.replaceChild(k,d)}else{c.removeChild(d)}b=true}}return b}function cleanFonts(d){var g=document.getElementById(d).contentWindow;var b=g.document.body.getElementsByTagName("FONT");if(b.length==0){return false}var e;var a;while(b.length>0){e=b[0];if(e.hasChildNodes&&e.childNodes.length==1&&e.childNodes[0].nodeType==1&&e.childNodes[0].nodeName=="SPAN"){var h=e.childNodes[0];copyAttribute(h,e);a=g.document.createRange();a.selectNode(e);a.insertNode(h);a.selectNode(e);a.deleteContents()}else{if(e.parentNode.nodeName=="SPAN"&&e.parentNode.childNodes.length==1){var h=e.parentNode;copyAttribute(h,e);h.innerHTML=e.innerHTML}else{var c=g.document.createElement("SPAN");copyAttribute(c,e);c.innerHTML=e.innerHTML;e.parentNode.replaceChild(c,e)}}}return true}function cleanTags(d,g,a){var h=document.getElementById(d).contentWindow;if(g.length==0){return false}var e;var b;while(g.length>0){e=g[0];if(e.hasChildNodes&&e.childNodes.length==1&&e.childNodes[0].nodeType==1&&e.childNodes[0].nodeName=="SPAN"){var i=e.childNodes[0];if(a=="bold"){i.style.fontWeight="bold"}if(a=="italic"){i.style.fontStyle="italic"}if(a=="line-through"){i.style.textDecoration="line-through"}if(a=="underline"){i.style.textDecoration="underline"}b=h.document.createRange();b.selectNode(e);b.insertNode(i);b.selectNode(e);b.deleteContents()}else{if(e.parentNode.nodeName=="SPAN"&&e.parentNode.childNodes.length==1){var i=e.parentNode;if(a=="bold"){i.style.fontWeight="bold"}if(a=="italic"){i.style.fontStyle="italic"}if(a=="line-through"){i.style.textDecoration="line-through"}if(a=="underline"){i.style.textDecoration="underline"}i.innerHTML=e.innerHTML}else{var c=h.document.createElement("SPAN");if(a=="bold"){c.style.fontWeight="bold"}if(a=="italic"){c.style.fontStyle="italic"}if(a=="line-through"){c.style.textDecoration="line-through"}if(a=="underline"){c.style.textDecoration="underline"}c.innerHTML=e.innerHTML;e.parentNode.replaceChild(c,e)}}}return true}function replaceTags(d,c,b){var g=document.getElementById(d).contentWindow;var e=g.document.body.getElementsByTagName(c);while(e.length>0){f=e[0];var a=g.document.createElement(b);a.innerHTML=f.innerHTML;f.parentNode.replaceChild(a,f)}}function copyAttribute(b,c){if((c.face!=null)&&(c.face!="")){b.style.fontFamily=c.face}if((c.size!=null)&&(c.size!="")){var a="";if(c.size==1){a="8pt"}else{if(c.size==2){a="10pt"}else{if(c.size==3){a="12pt"}else{if(c.size==4){a="14pt"}else{if(c.size==5){a="18pt"}else{if(c.size==6){a="24pt"}else{if(c.size>=7){a="36pt"}else{if(c.size<=-2||c.size=="0"){a="8pt"}else{if(c.size=="-1"){a="10pt"}else{if(c.size==0){a="12pt"}else{if(c.size=="+1"){a="14pt"}else{if(c.size=="+2"){a="18pt"}else{if(c.size=="+3"){a="24pt"}else{if(c.size=="+4"||c.size=="+5"||c.size=="+6"){a="36pt"}else{a=""}}}}}}}}}}}}}}if(a!=""){b.style.fontSize=a}}if((c.style.backgroundColor!=null)&&(c.style.backgroundColor!="")){b.style.backgroundColor=c.style.backgroundColor}if((c.color!=null)&&(c.color!="")){b.style.color=c.color}}function GetElement(b,a){while(b!=null&&b.tagName!=a){if(b.tagName=="BODY"){return null}b=b.parentNode}return b}function lineBreak1(a){arrReturn=["\n","",""];if(a=="A"||a=="B"||a=="CITE"||a=="CODE"||a=="EM"||a=="FONT"||a=="I"||a=="SMALL"||a=="STRIKE"||a=="BIG"||a=="STRONG"||a=="SUB"||a=="SUP"||a=="U"||a=="SAMP"||a=="S"||a=="VAR"||a=="BASEFONT"||a=="KBD"||a=="TT"){arrReturn=["","",""]}if(a=="TEXTAREA"||a=="TABLE"||a=="THEAD"||a=="TBODY"||a=="TR"||a=="OL"||a=="UL"||a=="DIR"||a=="MENU"||a=="FORM"||a=="SELECT"||a=="MAP"||a=="DL"||a=="HEAD"||a=="BODY"||a=="HTML"){arrReturn=["\n","","\n"]}if(a=="STYLE"||a=="SCRIPT"){arrReturn=["\n","",""]}if(a=="BR"||a=="HR"){arrReturn=["","\n",""]}return arrReturn}function fixAttr(a){a=String(a).replace(/&/g,"&amp;");a=String(a).replace(/</g,"&lt;");a=String(a).replace(/"/g,"&quot;");return a}function fixVal(b){b=String(b).replace(/&/g,"&amp;");b=String(b).replace(/</g,"&lt;");var a=escape(b);a=unescape(a.replace(/\%A0/gi,"-*REPL*-"));b=a.replace(/-\*REPL\*-/gi,"&nbsp;");return b}function recur(h,b){var e="";for(var g=0;g<h.childNodes.length;g++){var n=h.childNodes[g];if(n.nodeType==1){var a=n.nodeName;var m=false;if(a.substring(0,1)=="/"){m=true}else{var d=b;e+=lineBreak1(a)[0];if(lineBreak1(a)[0]!=""){e+=d}}if(m){}else{if(a=="OBJECT"||a=="EMBED"){s=getOuterHTML(n);s=s.replace(/\"[^\"]*\"/ig,function(i){i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#");return i});s=s.replace(/<([^ >]*)/ig,function(i){return i.toLowerCase()});s=s.replace(/ ([^=]+)=([^"' >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(i){return i.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/<param([^>]*)>/ig,"\n<param$1 />").replace(/\/ \/>$/ig," />");if(a=="EMBED"){if(n.innerHTML==""){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>")}}s=s.replace(/<param name=\"Play\" value=\"0\" \/>/,'<param name="Play" value="-1" />');e+=s}else{if(a=="TITLE"){e+="<title>"+n.innerHTML+"</title>"}else{if(a=="AREA"){var c=n.coords;var k=n.shape}var l=n.cloneNode(false);s=getOuterHTML(l).replace(/<\/[^>]*>/,"");if(a=="STYLE"){var j=s.match(/<[^>]*>/ig);s=j[0]}s=s.replace(/\"[^\"]*\"/ig,function(i){i=i.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s+/ig,"#_#");return i});s=s.replace(/<([^ >]*)/ig,function(i){return i.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(i){return i.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/[<hr]?(noshade="")/ig,'noshade="noshade"');s=s.replace(/[<input]?(checked="")/ig,'checked="checked"');s=s.replace(/[<select]?(multiple="")/ig,'multiple="multiple"');s=s.replace(/[<option]?(selected="")/ig,'selected="true"');s=s.replace(/[<input]?(readonly="")/ig,'readonly="readonly"');s=s.replace(/[<input]?(disabled="")/ig,'disabled="disabled"');s=s.replace(/[<td]?(nowrap="" )/ig,'nowrap="nowrap" ');s=s.replace(/[<td]?(nowrap=""\>)/ig,'nowrap="nowrap">');s=s.replace(/ contenteditable=\"true\"/ig,"");if(a=="AREA"){s=s.replace(/ coords=\"0,0,0,0\"/ig,' coords="'+c+'"');s=s.replace(/ shape=\"RECT\"/ig,' shape="'+k+'"')}var o=true;if(a=="IMG"||a=="BR"||a=="AREA"||a=="HR"||a=="INPUT"||a=="BASE"||a=="LINK"){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>");o=false}e+=s;if(a!="TEXTAREA"){e+=lineBreak1(a)[1]}if(a!="TEXTAREA"){if(lineBreak1(a)[1]!=""){e+=d}}if(o){s=getOuterHTML(n);if(a=="SCRIPT"){s=s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig,"<script$1>");s=s.replace(/[\n+\s+\t+]*<\/script>/ig,"<\/script>");s=s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig,"");s=s.replace(/\/\/\]\]><\/script>/ig,"");s=s.replace(/<script([^>]*)>/ig,"");s=s.replace(/<\/script>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+"//<![CDATA[\n"+d+s+"\n"+d+"//]]>\n"+d}if(a=="STYLE"){s=s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig,"<style$1>");s=s.replace(/[\n+\s+\t+]*<\/style>/ig,"</style>");s=s.replace(/<style([^>]*)><!--/ig,"");s=s.replace(/--><\/style>/ig,"");s=s.replace(/<style([^>]*)>/ig,"");s=s.replace(/<\/style>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+"<!--\n"+d+s+"\n"+d+"-->\n"+d}if(a=="DIV"||a=="P"){if(n.innerHTML==""||n.innerHTML=="&nbsp;"){e+="&nbsp;"}else{e+=recur(n,d+"\t")}}else{if(a=="STYLE"||a=="SCRIPT"){}else{e+=recur(n,d+"\t")}}if(a!="TEXTAREA"){e+=lineBreak1(a)[2]}if(a!="TEXTAREA"){if(lineBreak1(a)[2]!=""){e+=d}}e+="</"+a.toLowerCase()+">"}}}}}else{if(n.nodeType==3){e+=fixVal(n.nodeValue)}else{if(n.nodeType==8){if(getOuterHTML(n).substring(0,2)=="<%"){sTmp=(getOuterHTML(n).substring(2));sTmp=sTmp.substring(0,sTmp.length-2);sTmp=sTmp.replace(/^\s+/,"").replace(/\s+$/,"");var d=b;e+="\n"+d+"<%\n"+d+sTmp+"\n"+d+"%>\n"+d}else{var d=b;sTmp=n.nodeValue;sTmp=sTmp.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+"<!--\n"+d+sTmp+"\n"+d+"-->\n"+d}}else{}}}}return e}function getOuterHTML(c){var b="";switch(c.nodeType){case Node.ELEMENT_NODE:b="<"+c.nodeName;var d="";for(var a=0;a<c.attributes.length;a++){if(c.attributes[a].nodeName.substr(0,4)=="_moz"){continue}if(c.attributes[a].nodeValue.substr(0,4)=="_moz"){continue}if(c.nodeName=="TEXTAREA"&&c.attributes[a].nodeName.toLowerCase()=="value"){d=c.attributes[a].nodeValue}else{b+=" "+c.attributes[a].nodeName+'="'+c.attributes[a].nodeValue+'"'}}b+=">";b+=(c.nodeName!="TEXTAREA"?c.innerHTML:d);b+="</"+c.nodeName+">";break;case Node.COMMENT_NODE:b="<!--"+c.nodeValue+"-->";break;case Node.TEXT_NODE:b=c.nodeValue;break}return b}function toggleViewSource(a,b){if(a.checked){viewSource(b)}else{applySource(b)}}function viewSource(a){var d=document.getElementById(a).contentWindow;var c=getXHTMLBody(a);var b=d.document.body;b.innerHTML="";b.appendChild(d.document.createTextNode(c))}function applySource(b){var d=document.getElementById(b).contentWindow;var a=d.document.body.ownerDocument.createRange();a.selectNodeContents(d.document.body);var c=a.toString();c=c.replace(/>\s+</gi,"><");c=c.replace(/\r/gi,"");c=c.replace(/(<br>)\s+/gi,"$1");c=c.replace(/(<br\s*\/>)\s+/gi,"$1");c=c.replace(/\s+/gi," ");d.document.body.innerHTML=c};